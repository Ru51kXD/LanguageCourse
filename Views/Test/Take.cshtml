@using System.Text.Json
@model WebApplication15.Controllers.TestViewModel
@{
    ViewData["Title"] = Model.TestTitle;
    Layout = "~/Views/Shared/_Layout.cshtml";
    var totalQuestions = Model.Questions.Count;
}

<!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ -->
<script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    function hideVerticalCounters() {
        // –ò—â–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º —Å–æ–¥–µ—Ä–∂–∞—â–∏–º "–í–æ–ø—Ä–æ—Å X –∏–∑ Y"
        const allElements = document.querySelectorAll('div');
        for (let i = 0; i < allElements.length; i++) {
            const el = allElements[i];
            if (el.textContent && el.textContent.match(/–í–æ–ø—Ä–æ—Å \d –∏–∑ \d/)) {
                // –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
                el.style.cssText = 
                    'display: none !important;' + 
                    'visibility: hidden !important;' + 
                    'opacity: 0 !important;' + 
                    'height: 0 !important;' + 
                    'width: 0 !important;' + 
                    'position: absolute !important;' + 
                    'overflow: hidden !important;' + 
                    'clip: rect(0, 0, 0, 0) !important;' + 
                    'pointer-events: none !important;';
                
                // –ü—ã—Ç–∞–µ–º—Å—è —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM
                if (el.parentNode) {
                    try {
                        el.parentNode.removeChild(el);
                    } catch(e) {}
                }
            }
        }
    }
    
    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    (function() {
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º createElement
        const originalCreateElement = document.createElement;
        document.createElement = function() {
            const element = originalCreateElement.apply(document, arguments);
            
            // –î–ª—è div —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞
            if (arguments[0].toLowerCase() === 'div') {
                // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
                const originalInnerText = Object.getOwnPropertyDescriptor(Element.prototype, 'innerText');
                const originalTextContent = Object.getOwnPropertyDescriptor(Node.prototype, 'textContent');
                
                if (originalInnerText && originalInnerText.set) {
                    Object.defineProperty(element, 'innerText', {
                        set: function(value) {
                            if (value && typeof value === 'string' && value.match(/–í–æ–ø—Ä–æ—Å \d –∏–∑ \d/)) {
                                console.log('–ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫ —á–µ—Ä–µ–∑ innerText');
                                element.style.cssText = 'display:none!important;visibility:hidden!important';
                                return '';
                            }
                            return originalInnerText.set.call(this, value);
                        },
                        get: originalInnerText.get
                    });
                }
                
                if (originalTextContent && originalTextContent.set) {
                    Object.defineProperty(element, 'textContent', {
                        set: function(value) {
                            if (value && typeof value === 'string' && value.match(/–í–æ–ø—Ä–æ—Å \d –∏–∑ \d/)) {
                                console.log('–ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫ —á–µ—Ä–µ–∑ textContent');
                                element.style.cssText = 'display:none!important;visibility:hidden!important';
                                return '';
                            }
                            return originalTextContent.set.call(this, value);
                        },
                        get: originalTextContent.get
                    });
                }
            }
            
            return element;
        };
    })();
    
    // –í—ã–ø–æ–ª–Ω—è–µ–º –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', hideVerticalCounters);
    } else {
        hideVerticalCounters();
    }
    
    // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    setTimeout(hideVerticalCounters, 0);
    setTimeout(hideVerticalCounters, 100);
    setTimeout(hideVerticalCounters, 300);
    setTimeout(hideVerticalCounters, 500);
    setInterval(hideVerticalCounters, 1000);
</script>

<!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ -->
<style>
    /* –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ —Å –≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ */
    body div:has(div:contains("–í–æ–ø—Ä–æ—Å 1 –∏–∑ 5")),
    body div:has(div:contains("–í–æ–ø—Ä–æ—Å 2 –∏–∑ 5")),
    body div:has(div:contains("–í–æ–ø—Ä–æ—Å 3 –∏–∑ 5")),
    body div:has(div:contains("–í–æ–ø—Ä–æ—Å 4 –∏–∑ 5")),
    body div:has(div:contains("–í–æ–ø—Ä–æ—Å 5 –∏–∑ 5")) {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        position: absolute !important;
        height: 0 !important;
        width: 0 !important;
        overflow: hidden !important;
        clip: rect(0, 0, 0, 0) !important;
        margin: -1px !important;
        padding: 0 !important;
        border: 0 !important;
    }
    
    /* –ü—Ä—è–º–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —Ç–µ–∫—Å—Ç–æ–º '–í–æ–ø—Ä–æ—Å X –∏–∑ 5' */
    body *:not(script):not(style):not(link):not(meta) {
        visibility: visible;
    }
    
    body *:not(script):not(style):not(link):not(meta):has-text("–í–æ–ø—Ä–æ—Å 1 –∏–∑ 5"),
    body *:not(script):not(style):not(link):not(meta):has-text("–í–æ–ø—Ä–æ—Å 2 –∏–∑ 5"),
    body *:not(script):not(style):not(link):not(meta):has-text("–í–æ–ø—Ä–æ—Å 3 –∏–∑ 5"),
    body *:not(script):not(style):not(link):not(meta):has-text("–í–æ–ø—Ä–æ—Å 4 –∏–∑ 5"),
    body *:not(script):not(style):not(link):not(meta):has-text("–í–æ–ø—Ä–æ—Å 5 –∏–∑ 5") {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        height: 0 !important;
        position: absolute !important;
        pointer-events: none !important;
    }
</style>

<link rel="stylesheet" href="~/css/tests.css" />
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="~/css/test.css" />
<link rel="stylesheet" href="~/css/test-animations.css" />

<style>
    body {
        font-family: 'Nunito', sans-serif;
        background-color: #f7f7f7;
    }
    
    .duolingo-test-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .test-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        background-color: white;
        padding: 15px 20px;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    
    .progress-container {
        flex: 1;
        margin: 0 20px;
    }
    
    .progress-bar {
        height: 12px;
        background-color: #e5e5e5;
        border-radius: 6px;
        overflow: hidden;
    }
    
    .progress-fill {
        height: 100%;
        background-color: #58cc02;
        width: 0%;
        border-radius: 6px;
        transition: width 0.3s ease;
    }
    
    .question-number {
        font-weight: 700;
        color: #4b4b4b;
    }
    
    .timer {
        font-weight: 800;
        color: #4b4b4b;
        display: flex;
        align-items: center;
    }
    
    .timer-icon {
        margin-right: 8px;
        color: #ff5353;
    }
    
    .question-container {
        background-color: white;
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    
    .question-text {
        font-size: 24px;
        font-weight: 700;
        color: #3c3c3c;
        margin-bottom: 30px;
    }
    
    .options-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .option {
        padding: 15px 20px;
        border: 2px solid #e5e5e5;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
    }
    
    .option:hover {
        border-color: #a5a5a5;
        background-color: #f9f9f9;
    }
    
    .option.selected {
        border-color: #1cb0f6;
        background-color: rgba(28, 176, 246, 0.1);
    }
    
    .option-letter {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background-color: #f0f0f0;
        margin-right: 15px;
        font-weight: 700;
        color: #4b4b4b;
    }
    
    .option.selected .option-letter {
        background-color: #1cb0f6;
        color: white;
    }
    
    .option-text {
        font-size: 18px;
        font-weight: 600;
        color: #3c3c3c;
    }
    
    .action-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .button {
        padding: 12px 24px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.2s ease;
        border: none;
    }
    
    .primary-button {
        background-color: #58cc02;
        color: white;
        box-shadow: 0 4px 0 #58a700;
    }
    
    .primary-button:hover {
        background-color: #62de03;
        transform: translateY(-2px);
    }
    
    .primary-button:active {
        background-color: #58cc02;
        transform: translateY(0);
        box-shadow: 0 2px 0 #58a700;
    }
    
    .secondary-button {
        background-color: #f7f7f7;
        color: #3c3c3c;
        box-shadow: 0 4px 0 #e5e5e5;
    }
    
    .secondary-button:hover {
        background-color: #f0f0f0;
        transform: translateY(-2px);
    }
    
    .secondary-button:active {
        background-color: #f7f7f7;
        transform: translateY(0);
        box-shadow: 0 2px 0 #e5e5e5;
    }
    
    .button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none !important;
    }
    
    .fade-in-up {
        animation: fadeInUp 0.5s ease forwards;
    }
    
    .success-animation {
        animation: pulse 0.5s ease;
    }
    
    .slide-in-right {
        animation: slideInRight 0.5s ease forwards;
    }
    
    .slide-in-left {
        animation: slideInLeft 0.5s ease forwards;
    }
    
    .correct-answer {
        background-color: rgba(88, 204, 2, 0.2) !important;
        border-color: #58cc02 !important;
    }
    
    .wrong-answer {
        background-color: rgba(255, 83, 83, 0.2) !important;
        border-color: #ff5353 !important;
    }
    
    .score-title {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 20px;
        color: #3c3c3c;
    }
    
    .confetti {
        position: fixed;
        width: 10px;
        height: 10px;
        background-color: #58cc02;
        opacity: 0;
        border-radius: 50%;
        animation: confetti 5s ease-in-out infinite;
    }
    
    .result-summary {
        background-color: white;
        border-radius: 16px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.07);
        text-align: center;
    }
    
    .score-circle {
        width: 180px;
        height: 180px;
        border-radius: 50%;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        background: conic-gradient(
            #58cc02 0% calc(var(--score, 0) * 1%),
            #e5e5e5 calc(var(--score, 0) * 1%) 100%
        );
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    
    .score-circle::before {
        content: "";
        position: absolute;
        inset: 20px;
        border-radius: 50%;
        background-color: white;
    }
    
    .score-value {
        position: relative;
        z-index: 1;
        font-size: 36px;
        font-weight: 800;
        color: #3c3c3c;
    }
    
    .score-message {
        font-size: 24px;
        font-weight: 700;
    }
    
    .score-message.excellent {
        color: #58cc02;
    }
    
    .score-message.good {
        color: #fecb2e;
    }
    
    .score-message.poor {
        color: #ff5353;
    }
    
    .score-circle.excellent {
        --score: 0;
        border-color: #58cc02;
    }
    
    .score-circle.good {
        --score: 0;
        border-color: #fecb2e;
    }
    
    .score-circle.poor {
        --score: 0;
        border-color: #ff5353;
    }
    
    .details-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-top: 30px;
    }
    
    .detail-item {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 10px;
    }
    
    .detail-label {
        font-size: 14px;
        color: #777;
        margin-bottom: 5px;
    }
    
    .detail-value {
        font-size: 18px;
        font-weight: 700;
        color: #3c3c3c;
    }
    
    .duolingo-character {
        position: fixed;
        bottom: 20px;
        right: 80px;
        transition: bottom 0.5s ease;
        z-index: 1000;
    }
    
    .duolingo-character img {
        width: 120px;
        height: auto;
    }
    
    .character-bubble {
        position: absolute;
        top: -80px;
        right: 0;
        background-color: white;
        border-radius: 20px;
        padding: 10px 15px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        font-weight: 600;
        min-width: 200px;
        text-align: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .character-bubble::after {
        content: "";
        position: absolute;
        bottom: -10px;
        right: 30px;
        left: auto;
        transform: none;
        border-width: 10px 10px 0;
        border-style: solid;
        border-color: white transparent transparent;
    }
    
    /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ */
    .question-indicators {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
        gap: 10px;
    }
    
    .question-indicator {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 16px;
        background-color: #e5e5e5;
        color: #555;
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
    }
    
    .question-indicator.active {
        background-color: #58cc02;
        color: white;
        transform: scale(1.1);
        box-shadow: 0 4px 10px rgba(88, 204, 2, 0.3);
    }
    
    .question-indicator.completed {
        background-color: #b8e986;
        color: #3c6300;
    }
    
    .question-indicator.correct {
        background-color: #58cc02;
        color: white;
    }
    
    .question-indicator.incorrect {
        background-color: #ff7676;
        color: white;
    }
    
    .question-indicator::after {
        content: '';
        position: absolute;
        width: 20px;
        height: 3px;
        background-color: #e5e5e5;
        right: -15px;
        top: 50%;
        transform: translateY(-50%);
    }
    
    .question-indicator:last-child::after {
        display: none;
    }
    
    .question-indicator.completed::after, 
    .question-indicator.correct::after,
    .question-indicator.incorrect::after {
        background-color: #b8e986;
    }
    
    .question-status-text {
        text-align: center;
        margin-bottom: 15px;
        font-size: 16px;
        color: #666;
        font-weight: 600;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ */
    .questions-progress-bar {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 30px;
        padding: 10px;
        background-color: #f5f5f5;
        border-radius: 10px;
        max-width: 350px;
        margin-left: auto;
        margin-right: auto;
    }
    
    .question-step {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #e0e0e0;
        color: #555;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        position: relative;
    }
    
    .question-step.active {
        background-color: #58cc02;
        color: white;
        transform: scale(1.1);
        box-shadow: 0 4px 10px rgba(88, 204, 2, 0.2);
    }
    
    .question-step.completed {
        background-color: #b8e986;
        color: #3c6300;
    }
    
    .question-step::after {
        content: "";
        position: absolute;
        width: 15px;
        height: 2px;
        background-color: #ccc;
        right: -15px;
    }
    
    .question-step:last-child::after {
        display: none;
    }
    
    /* –°–∫—Ä—ã–≤–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç */
    .vertical-questions-list {
        display: none;
    }
    
    /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ */
    .question-card > div:nth-child(2),
    .question-card > div:nth-child(3),
    .question-card > div:nth-child(4),
    .question-card > div:nth-child(5),
    .question-card > div:nth-child(6) {
        display: none !important;
    }
    
    /* –ü—Ä—è–º–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –ø–æ —Ç–µ–∫—Å—Ç—É (–∏—Å–ø–æ–ª—å–∑—É–µ–º –∞—Ç—Ä–∏–±—É—Ç data-hide –¥–ª—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏) */
    [data-hide-vertical="true"] {
        display: none !important;
    }
    
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏ */
    .question-card div[class=""],
    .question-card div:not([class]) {
        display: none !important;
    }
</style>

<div class="duolingo-test-container">
    <div class="timer-container">
        <i class="fas fa-clock"></i>
        <span class="timer-text" id="timer">@Model.TimeLimit:00</span>
    </div>
    
    <div class="test-progress-bar">
        <div class="test-progress-fill" id="progressBar" style="width: 0%"></div>
    </div>
    
    <div class="question-card d-none" id="questionContainer">
        <!-- –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫ -->
        <div hidden aria-hidden="true" style="display:none!important;visibility:hidden!important;opacity:0!important;height:0!important;width:0!important;">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 5</div>
        <div hidden aria-hidden="true" style="display:none!important;visibility:hidden!important;opacity:0!important;height:0!important;width:0!important;">–í–æ–ø—Ä–æ—Å 2 –∏–∑ 5</div>
        <div hidden aria-hidden="true" style="display:none!important;visibility:hidden!important;opacity:0!important;height:0!important;width:0!important;">–í–æ–ø—Ä–æ—Å 3 –∏–∑ 5</div>
        <div hidden aria-hidden="true" style="display:none!important;visibility:hidden!important;opacity:0!important;height:0!important;width:0!important;">–í–æ–ø—Ä–æ—Å 4 –∏–∑ 5</div>
        <div hidden aria-hidden="true" style="display:none!important;visibility:hidden!important;opacity:0!important;height:0!important;width:0!important;">–í–æ–ø—Ä–æ—Å 5 –∏–∑ 5</div>
        
        <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º -->
        <div class="questions-navigation" id="questionsNavigation"></div>
        
        <h2 class="question-text" id="questionText"></h2>
        <div class="options-container" id="optionsContainer"></div>
        <div class="navigation-buttons">
            <button type="button" class="nav-button button-prev" id="prevBtn" disabled>–ù–∞–∑–∞–¥</button>
            <button type="button" class="nav-button button-next" id="nextBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        </div>
        
        <div class="duolingo-character" id="duoCharacter">
            <div class="character-bubble" id="characterBubble"></div>
            <div style="font-size: 80px; text-align: center;">üôÇ</div>
        </div>
    </div>
    
    <div id="resultContainer" class="d-none text-center">
        <div class="py-5 mt-4">
            <i class="fas fa-spinner fa-spin fa-3x mb-3"></i>
            <h2>–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞—à–∏ –æ—Ç–≤–µ—Ç—ã...</h2>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –î–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–∞
            const testId = @Model.TestId;
            const testTitle = "@Model.TestTitle";
            const language = "@Model.Language";
            const level = "@Model.Level";
            const timeLimit = @Model.TimeLimit;
            const questions = @Html.Raw(Json.Serialize(Model.Questions));
            const totalQuestions = questions.length;
            
            // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–∞
            let currentQuestionIndex = 0;
            let answers = {};
            let timerInterval;
            let timeLeft = timeLimit * 60; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            let checkMode = false; // —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–∞
            let correctAnswers = 0; // —Å—á–µ—Ç—á–∏–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
            
            const questionContainer = document.getElementById('questionContainer');
            const questionText = document.getElementById('questionText');
            const optionsContainer = document.getElementById('optionsContainer');
            const progressBar = document.getElementById('progressBar');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const timerElement = document.getElementById('timer');
            const resultContainer = document.getElementById('resultContainer');
            const duoCharacter = document.getElementById('duoCharacter');
            const characterBubble = document.getElementById('characterBubble');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞
            initTest();
            
            function initTest() {
                questionContainer.classList.remove('d-none');
                
                // –°–æ–∑–¥–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                createHorizontalQuestionsNavigation();
                
                // –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤
                createQuestionIndicators();
                
                showQuestion(0);
                startTimer();
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
                prevBtn.addEventListener('click', goToPrevQuestion);
                nextBtn.addEventListener('click', handleNextButton);
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                createConfetti();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º
                setTimeout(() => {
                    showCharacterBubble('–£–¥–∞—á–∏ —Å —Ç–µ—Å—Ç–æ–º! –Ø –≤–µ—Ä—é –≤ —Ç–µ–±—è! üëç');
                }, 1000);
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
            function createConfetti() {
                const colors = ['#58cc02', '#82d900', '#ff5252', '#ffc107', '#3f51b5', '#2196f3'];
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = (Math.random() * 10 + 5) + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.animationDelay = Math.random() * 5 + 's';
                    confetti.style.animationDuration = (Math.random() * 5 + 5) + 's';
                    document.body.appendChild(confetti);
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            function showCharacterBubble(text) {
                characterBubble.textContent = text;
                characterBubble.style.opacity = '1';
                
                setTimeout(() => {
                    characterBubble.style.opacity = '0';
                }, 4000);
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –î–∞–ª–µ–µ/–ü—Ä–æ–≤–µ—Ä–∏—Ç—å
            function handleNextButton() {
                const currentQuestion = questions[currentQuestionIndex];
                
                // –ï—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω –æ—Ç–≤–µ—Ç
                if (!answers[currentQuestion.id]) {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    if (!document.querySelector('.answer-required-message')) {
                        const message = document.createElement('div');
                        message.className = 'alert alert-warning mt-3 answer-required-message';
                        message.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞.';
                        questionContainer.appendChild(message);
                        
                        // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                        setTimeout(() => {
                            if (message.parentNode) {
                                message.parentNode.removeChild(message);
                            }
                        }, 3000);
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
                        showCharacterBubble('–ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞! üëÄ');
                    }
                    return;
                }
                
                if (!checkMode) {
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏
                    checkMode = true;
                    checkAnswer();
                    return;
                }
                
                // –ï—Å–ª–∏ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
                checkMode = false;
                if (currentQuestionIndex < totalQuestions - 1) {
                    showQuestion(currentQuestionIndex + 1);
                } else {
                    finishTest();
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
            function checkAnswer() {
                const currentQuestion = questions[currentQuestionIndex];
                const userAnswer = answers[currentQuestion.id];
                const correctOption = currentQuestion.options.find(opt => opt.isCorrect);
                
                // –ù–∞—Ö–æ–¥–∏–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
                const options = document.querySelectorAll('.option-item');
                let correct = false;
                
                options.forEach(option => {
                    const input = option.querySelector('input');
                    const label = option.querySelector('label');
                    
                    if (input.checked) {
                        if (input.value === correctOption.text) {
                            // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                            option.classList.add('correct-answer');
                            option.classList.add('success-animation');
                            showCorrectFeedback();
                            correct = true;
                            correctAnswers++;
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
                            const messages = [
                                '–û—Ç–ª–∏—á–Ω–æ! –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å! üëè',
                                '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –¢—ã –º–æ–ª–æ–¥–µ—Ü! üéâ',
                                '–°—É–ø–µ—Ä! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üåü',
                                '–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ! –¢—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä—É–µ—à—å! üöÄ'
                            ];
                            showCharacterBubble(messages[Math.floor(Math.random() * messages.length)]);
                        } else {
                            // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                            option.classList.add('wrong-answer');
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                            options.forEach(opt => {
                                const optInput = opt.querySelector('input');
                                if (optInput.value === correctOption.text) {
                                    opt.classList.add('correct-answer');
                                }
                            });
                            
                            showWrongFeedback();
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
                            const messages = [
                                '–ù–µ —É–Ω—ã–≤–∞–π! –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–ª—É—á–∏—Ç—Å—è! üí™',
                                '–û—à–∏–±–∫–∏ - —ç—Ç–æ —á–∞—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è! üìö',
                                '–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –≤—ã–¥–µ–ª–µ–Ω. –ó–∞–ø–æ–º–Ω–∏ –µ–≥–æ! üß†',
                                '–ü—Ä–æ–¥–æ–ª–∂–∞–π —Å—Ç–∞—Ä–∞—Ç—å—Å—è! üå±'
                            ];
                            showCharacterBubble(messages[Math.floor(Math.random() * messages.length)]);
                        }
                    }
                    
                    // –î–µ–ª–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏
                    input.disabled = true;
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤
                updateQuestionIndicators();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
                nextBtn.textContent = currentQuestionIndex === totalQuestions - 1 ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å' : '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                updateQuestionsNavigation();
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
            function showCorrectFeedback() {
                const feedback = document.createElement('div');
                feedback.className = 'alert alert-success mt-4 fade-in-up';
                feedback.innerHTML = '<i class="fas fa-check-circle me-2"></i> –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                questionContainer.appendChild(feedback);
                
                // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
                const audio = new Audio('/sounds/correct.mp3');
                audio.play().catch(e => console.log('–ê—É–¥–∏–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ:', e));
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
            function showWrongFeedback() {
                const feedback = document.createElement('div');
                feedback.className = 'alert alert-danger mt-4 fade-in-up';
                feedback.innerHTML = '<i class="fas fa-times-circle me-2"></i> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!';
                questionContainer.appendChild(feedback);
                
                // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
                const audio = new Audio('/sounds/wrong.mp3');
                audio.play().catch(e => console.log('–ê—É–¥–∏–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ:', e));
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –∏–Ω–¥–µ–∫—Å—É
            function showQuestion(index) {
                if (index < 0 || index >= totalQuestions) return;
                
                currentQuestionIndex = index;
                const question = questions[index];
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
                const feedbacks = questionContainer.querySelectorAll('.alert');
                feedbacks.forEach(feedback => feedback.remove());
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                updateProgress();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                updateQuestionsNavigation();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
                prevBtn.disabled = index === 0;
                
                if (index === totalQuestions - 1) {
                    nextBtn.textContent = checkMode ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å' : '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
                } else {
                    nextBtn.textContent = checkMode ? '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤
                updateQuestionIndicators();
                
                // –û—á–∏—â–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –≤–æ–ø—Ä–æ—Å
                questionText.innerHTML = '';
                questionText.classList.remove('slide-in-right');
                void questionText.offsetWidth; // —Ç—Ä–∏–≥–≥–µ—Ä reflow
                
                // –ê–Ω–∏–º–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å
                questionText.classList.add('slide-in-right');
                questionText.textContent = question.text;
                
                // –û—á–∏—â–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
                optionsContainer.innerHTML = '';
                optionsContainer.classList.remove('slide-in-left');
                void optionsContainer.offsetWidth; // —Ç—Ä–∏–≥–≥–µ—Ä reflow
                optionsContainer.classList.add('slide-in-left');
                
                question.options.forEach((option, optionIndex) => {
                    const optionId = `option_${index}_${optionIndex}`;
                    const isChecked = answers[question.id] === option.text;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option-item';
                    
                    optionDiv.innerHTML = `
                        <input type="radio" id="${optionId}" name="question_${index}" value="${option.text}" ${isChecked ? 'checked' : ''} />
                        <label for="${optionId}">${option.text}</label>
                    `;
                    
                    optionsContainer.appendChild(optionDiv);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è
                    const radioInput = document.getElementById(optionId);
                    radioInput.addEventListener('change', () => {
                        answers[question.id] = option.text;
                        
                        // –≠—Ñ—Ñ–µ–∫—Ç –≤—ã–±–æ—Ä–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞
                        optionsContainer.querySelectorAll('.option-item').forEach(op => {
                            op.classList.remove('selected');
                        });
                        optionDiv.classList.add('selected');
                    });
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –ø–æ–¥–±–∞–¥—Ä–∏–≤–∞—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ –Ω–æ–≤–æ–º—É –≤–æ–ø—Ä–æ—Å—É
                if (index > 0 && !checkMode) {
                    const progressPercentage = (index / totalQuestions) * 100;
                    if (progressPercentage >= 50 && progressPercentage < 75) {
                        showCharacterBubble('–£–∂–µ –ø–æ–ª–æ–≤–∏–Ω–∞ –ø—Ä–æ–π–¥–µ–Ω–∞! –¢—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è! üëç');
                    } else if (progressPercentage >= 75) {
                        showCharacterBubble('–û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ! –¢—ã –ø–æ—á—Ç–∏ —É —Ü–µ–ª–∏! üèÅ');
                    }
                }
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
            function createQuestionIndicators() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                let indicatorsContainer = document.querySelector('.question-indicators');
                if (!indicatorsContainer) {
                    // –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—É—Å —Ç–µ–∫—Å—Ç
                    const statusText = document.createElement('div');
                    statusText.className = 'question-status-text';
                    statusText.textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} –∏–∑ ${totalQuestions}`;
                    questionContainer.insertBefore(statusText, questionText);
                    
                    // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
                    indicatorsContainer = document.createElement('div');
                    indicatorsContainer.className = 'question-indicators';
                    questionContainer.insertBefore(indicatorsContainer, statusText);
                    
                    // –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                    for (let i = 0; i < totalQuestions; i++) {
                        const indicator = document.createElement('div');
                        indicator.className = 'question-indicator';
                        indicator.textContent = i + 1;
                        indicator.dataset.index = i;
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞, –µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å —É–∂–µ –±—ã–ª –ø—Ä–æ–π–¥–µ–Ω
                        indicator.addEventListener('click', function() {
                            const index = parseInt(this.dataset.index);
                            // –†–∞–∑—Ä–µ—à–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –ø–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–º –≤–æ–ø—Ä–æ—Å–∞–º –∏–ª–∏ —Ç–µ–∫—É—â–µ–º—É
                            if (index <= currentQuestionIndex) {
                                showQuestion(index);
                            }
                        });
                        
                        indicatorsContainer.appendChild(indicator);
                    }
                }
                
                updateQuestionIndicators();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
            function updateQuestionIndicators() {
                const indicators = document.querySelectorAll('.question-indicator');
                const statusText = document.querySelector('.question-status-text');
                
                if (statusText) {
                    statusText.textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} –∏–∑ ${totalQuestions}`;
                }
                
                if (indicators.length) {
                    indicators.forEach((indicator, i) => {
                        // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è
                        indicator.classList.remove('active', 'completed', 'correct', 'incorrect');
                        
                        if (i === currentQuestionIndex) {
                            // –¢–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å
                            indicator.classList.add('active');
                        } else if (i < currentQuestionIndex) {
                            // –ü—Ä–æ–π–¥–µ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å
                            indicator.classList.add('completed');
                            
                            // –ï—Å–ª–∏ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏
                            if (checkMode) {
                                const questionId = questions[i].id;
                                const userAnswer = answers[questionId];
                                const correctOption = questions[i].options.find(opt => opt.isCorrect);
                                
                                if (userAnswer === correctOption.text) {
                                    indicator.classList.add('correct');
                                } else {
                                    indicator.classList.add('incorrect');
                                }
                            }
                        }
                    });
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
            function updateProgress() {
                const progressPercentage = ((currentQuestionIndex + 1) / totalQuestions) * 100;
                progressBar.style.width = `${progressPercentage}%`;
            }
            
            // –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
            function goToPrevQuestion() {
                if (currentQuestionIndex > 0) {
                    checkMode = false;
                    showQuestion(currentQuestionIndex - 1);
                }
            }
            
            // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
            function startTimer() {
                updateTimerDisplay();
                
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    
                    // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≤—Ä–µ–º–µ–Ω–∏
                    if (timeLeft === 60) {
                        showCharacterBubble('–û—Å—Ç–∞–ª–∞—Å—å –≤—Å–µ–≥–æ –º–∏–Ω—É—Ç–∞! –ü–æ—Ç–æ—Ä–æ–ø–∏—Å—å! ‚è±Ô∏è');
                    }
                    
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        finishTest();
                    }
                }, 1000);
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
            function updateTimerDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç, –∫–æ–≥–¥–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –º–∞–ª–æ –≤—Ä–µ–º–µ–Ω–∏
                if (timeLeft <= 60) {
                    timerElement.style.color = '#ff5353';
                }
            }
            
            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
            function finishTest() {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
                clearInterval(timerInterval);
                
                // –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
                updateQuestionIndicators();
                
                // –°–∫—Ä—ã–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                questionContainer.classList.add('d-none');
                resultContainer.classList.remove('d-none');
                
                // –í—ã—á–∏—Å–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                const score = Math.round((correctAnswers / totalQuestions) * 100);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                document.getElementById('finalScore').textContent = score;
                document.getElementById('correctAnswers').textContent = correctAnswers;
                document.getElementById('totalQuestionsResult').textContent = totalQuestions;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                let resultMessage = '';
                let characterMessage = '';
                
                if (score >= 90) {
                    resultMessage = '–û—Ç–ª–∏—á–Ω–æ! –í—ã –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å —Ç–µ—Å—Ç–æ–º!';
                    characterMessage = '–í–∞—É! –Ø –≤–ø–µ—á–∞—Ç–ª–µ–Ω! –¢—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –ø–æ–ª–∏–≥–ª–æ—Ç! üèÜ';
                } else if (score >= 70) {
                    resultMessage = '–•–æ—Ä–æ—à–æ! –í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ —Ç–µ—Å—Ç!';
                    characterMessage = '–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢—ã –º–æ–ª–æ–¥–µ—Ü! üéâ';
                } else if (score >= 50) {
                    resultMessage = '–ù–µ–ø–ª–æ—Ö–æ! –ù–æ –µ—Å—Ç—å –∫ —á–µ–º—É —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è.';
                    characterMessage = '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è! üå±';
                } else {
                    resultMessage = '–°—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞.';
                    characterMessage = '–ù–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Å—è! –ö–∞–∂–¥–∞—è –æ—à–∏–±–∫–∞ - —ç—Ç–æ —à–∞–≥ –∫ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É! üí™';
                }
                
                document.getElementById('resultMessage').textContent = resultMessage;
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä—É–≥–∞
                const circle = document.querySelector('.score-circle-fill');
                setTimeout(() => {
                    circle.style.strokeDashoffset = 440 - (440 * score / 100);
                    document.querySelector('.confetti-container').classList.add('active');
                }, 500);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ–º
                setTimeout(() => {
                    showCharacterBubble(characterMessage);
                }, 1000);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                saveTestResult(score);
                
                // –°–Ω–∏–º–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
                document.querySelectorAll('.question-indicator').forEach(indicator => {
                    indicator.removeEventListener('click', function() {});
                    indicator.style.cursor = 'default'; // –£–±–∏—Ä–∞–µ–º –∫—É—Ä—Å–æ—Ä-—É–∫–∞–∑–∞—Ç–µ–ª—å
                });
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            function submitTest() {
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –æ—Ç–≤–µ—Ç–æ–≤ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                const submissionData = {
                    testId: testId,
                    answers: answers
                };
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                fetch('/Test/Submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]')?.value || ''
                    },
                    body: JSON.stringify(submissionData)
                })
                .then(response => response.json())
                .then(data => {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    showResults(data);
                    
                    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏
                    setTimeout(() => {
                        window.location.href = data.profileUrl || '/Account/Profile';
                    }, 8000);
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:', error);
                    resultContainer.innerHTML = `
                        <div class="py-5 mt-4">
                            <i class="fas fa-exclamation-circle fa-3x mb-3 text-danger"></i>
                            <h2>–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>
                            <p class="text-muted">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑</p>
                            <a href="/Test" class="btn btn-primary mt-3">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–µ—Å—Ç–∞–º</a>
                        </div>
                    `;
                });
            }
            
            // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∞
            function showResults(data) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å scorePercentage
                let scorePercentage = 0;
                if (data.score !== undefined && !isNaN(data.score)) {
                    scorePercentage = Math.round(data.score);
                } else if (data.correctAnswers !== undefined && data.totalQuestions !== undefined) {
                    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª-–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
                    scorePercentage = Math.round((data.correctAnswers / data.totalQuestions) * 100);
                }
                
                let resultClass = 'neutral';
                let resultEmoji = 'üéì';
                let resultMessage = '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!';
                
                if (scorePercentage >= 80) {
                    resultClass = 'excellent';
                    resultMessage = '–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!';
                    resultEmoji = 'ü•á';
                } else if (scorePercentage >= 60) {
                    resultClass = 'good';
                    resultMessage = '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!';
                    resultEmoji = 'üèÜ';
                } else if (scorePercentage < 40) {
                    resultClass = 'poor';
                    resultMessage = '–°—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª';
                    resultEmoji = 'üìö';
                }
                
                const correctAnswers = data.correctAnswers || 0;
                const totalQuestions = data.totalQuestions || 0;
                
                resultContainer.innerHTML = `
                    <div class="result-summary p-4 mt-4 mb-5">
                        <h1 class="score-title mb-4">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ ${resultEmoji}</h1>
                        <div class="score-circle ${resultClass}" style="--score: ${scorePercentage}">
                            <div class="score-value">${scorePercentage}%</div>
                        </div>
                        <h2 class="score-message ${resultClass} mt-4">${resultMessage}</h2>
                        <p class="score-description">–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ ${correctAnswers} –∏–∑ ${totalQuestions} –≤–æ–ø—Ä–æ—Å–æ–≤.</p>
                        
                        <div class="result-details mt-5">
                            <div class="details-grid">
                                <div class="detail-item">
                                    <div class="detail-label">–Ø–∑—ã–∫</div>
                                    <div class="detail-value">${data.language || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">–£—Ä–æ–≤–µ–Ω—å</div>
                                    <div class="detail-value">${data.level || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                                    <div class="detail-value">${correctAnswers} –∏–∑ ${totalQuestions}</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">–ü—Ä–æ—Ü–µ–Ω—Ç</div>
                                    <div class="detail-value">${scorePercentage}%</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="actions mt-5">
                            <a href="/Test/Take/${testId}" class="btn btn-primary me-3">–ü—Ä–æ–π—Ç–∏ –µ—â–µ —Ä–∞–∑</a>
                            <a href="/Test/Index" class="btn btn-secondary">–ö —Å–ø–∏—Å–∫—É —Ç–µ—Å—Ç–æ–≤</a>
                        </div>
                    </div>
                `;
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
                document.querySelectorAll('.confetti').forEach(c => {
                    c.style.opacity = '1';
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                if (document.querySelector('.duolingo-character')) {
                    document.querySelector('.duolingo-character').style.zIndex = '1500';
                } else {
                    const duoElement = document.createElement('div');
                    duoElement.className = 'duolingo-character';
                    duoElement.id = 'resultDuoCharacter';
                    duoElement.innerHTML = `
                        <div class="character-bubble" id="resultCharacterBubble"></div>
                        <div style="font-size: 80px; text-align: center;">üôÇ</div>
                    `;
                    document.body.appendChild(duoElement);
                    
                    const resultCharacterBubble = document.getElementById('resultCharacterBubble');
                    resultCharacterBubble.textContent = '–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢—ã –º–æ–ª–æ–¥–µ—Ü! üëè';
                    resultCharacterBubble.style.opacity = '1';
                    
                    setTimeout(() => {
                        resultCharacterBubble.style.opacity = '0';
                    }, 4000);
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            function createHorizontalQuestionsNavigation() {
                const questionsNavigation = document.getElementById('questionsNavigation');
                if (!questionsNavigation) return;
                
                // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                questionsNavigation.innerHTML = '';
                
                // –°–æ–∑–¥–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                const navigationBar = document.createElement('div');
                navigationBar.className = 'questions-progress-bar';
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                for (let i = 0; i < totalQuestions; i++) {
                    const questionStep = document.createElement('a');
                    questionStep.className = 'question-step';
                    questionStep.textContent = i + 1;
                    questionStep.href = '#';
                    questionStep.addEventListener('click', function(e) {
                        e.preventDefault();
                        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–æ–ø—Ä–æ—Å—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω
                        if (i <= currentQuestionIndex) {
                            showQuestion(i);
                        }
                    });
                    
                    navigationBar.appendChild(questionStep);
                }
                
                questionsNavigation.appendChild(navigationBar);
                updateQuestionsNavigation();
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            function updateQuestionsNavigation() {
                const questionSteps = document.querySelectorAll('.question-step');
                
                questionSteps.forEach((step, index) => {
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–ª–∞—Å—Å—ã
                    step.classList.remove('active', 'completed');
                    
                    if (index === currentQuestionIndex) {
                        step.classList.add('active');
                    } else if (index < currentQuestionIndex) {
                        step.classList.add('completed');
                    }
                });
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –º–æ—â–Ω—ã–π MutationObserver –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π DOM –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞
            function setupMutationObserver() {
                // –ù–∞—Ö–æ–¥–∏–º –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏
                const targetNode = document.querySelector('.question-card');
                if (!targetNode) {
                    console.log('–¶–µ–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è
                const config = { 
                    childList: true,  // –Ω–∞–±–ª—é–¥–∞–µ–º –∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º/—É–¥–∞–ª–µ–Ω–∏–µ–º –¥–æ—á–µ—Ä–Ω–∏—Ö —É–∑–ª–æ–≤
                    subtree: true,    // –Ω–∞–±–ª—é–¥–∞–µ–º –∑–∞ –≤—Å–µ–º –¥–µ—Ä–µ–≤–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                    attributes: true  // –Ω–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∞—Ç—Ä–∏–±—É—Ç–æ–≤
                };
                
                // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
                const callback = function(mutationsList, observer) {
                    for (const mutation of mutationsList) {
                        if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —É–∑–ª—ã
                            mutation.addedNodes.forEach(node => {
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —É–∑–µ–ª —ç–ª–µ–º–µ–Ω—Ç–æ–º
                                if (node.nodeType === Node.ELEMENT_NODE) {
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∞–º —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–µ–∫—Å—Ç–∞ "–í–æ–ø—Ä–æ—Å X –∏–∑ 5"
                                    if (node.textContent && node.textContent.match(/–í–æ–ø—Ä–æ—Å \d –∏–∑ \d/)) {
                                        console.log('–ù–∞–π–¥–µ–Ω –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫, —É–¥–∞–ª—è–µ–º:', node.textContent);
                                        node.remove();
                                    }
                                    
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                                    const verticalElements = node.querySelectorAll('div');
                                    verticalElements.forEach(el => {
                                        if (el.textContent && el.textContent.match(/–í–æ–ø—Ä–æ—Å \d –∏–∑ \d/)) {
                                            console.log('–ù–∞–π–¥–µ–Ω –¥–æ—á–µ—Ä–Ω–∏–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫, —É–¥–∞–ª—è–µ–º:', el.textContent);
                                            el.remove();
                                        }
                                    });
                                }
                            });
                            
                            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                            removeAllVerticalCounters();
                        }
                    }
                };
                
                // –°–æ–∑–¥–∞–µ–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è —Å –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
                const observer = new MutationObserver(callback);
                
                // –ù–∞—á–∏–Ω–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ —Ü–µ–ª–µ–≤—ã–º —É–∑–ª–æ–º —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
                observer.observe(targetNode, config);
                console.log('MutationObserver –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω');
                
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—á–µ—Ç—á–∏–∫–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                removeAllVerticalCounters();
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤
            function removeAllVerticalCounters() {
                // –ò—â–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º "–í–æ–ø—Ä–æ—Å X –∏–∑ Y"
                document.querySelectorAll('div').forEach(div => {
                    if (div.textContent && div.textContent.match(/–í–æ–ø—Ä–æ—Å \d –∏–∑ \d/)) {
                        // –°–Ω–∞—á–∞–ª–∞ —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∏–ª—è–º–∏
                        div.style.cssText = 'display: none !important; visibility: hidden !important; opacity: 0 !important; height: 0 !important; position: absolute !important; overflow: hidden !important; pointer-events: none !important;';
                        
                        // –ó–∞—Ç–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ–º –∏–∑ DOM (–µ—Å–ª–∏ —É —ç–ª–µ–º–µ–Ω—Ç–∞ –µ—Å—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å)
                        if (div.parentNode) {
                            try {
                                div.parentNode.removeChild(div);
                                console.log('–£—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫');
                            } catch(e) {
                                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞:', e);
                            }
                        }
                    }
                });
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º MutationObserver –ø–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
            setTimeout(setupMutationObserver, 100);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
            const removalInterval = setInterval(removeAllVerticalCounters, 200);
            
            // –û—Å—Ç–∞–Ω–æ–≤–∏–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ—Å–ª–µ 30 —Å–µ–∫—É–Ω–¥ (150 –ø–æ–ø—ã—Ç–æ–∫)
            setTimeout(() => {
                clearInterval(removalInterval);
                console.log('–ò–Ω—Ç–µ—Ä–≤–∞–ª —É–¥–∞–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
            }, 30000);
        });
    </script>
} 